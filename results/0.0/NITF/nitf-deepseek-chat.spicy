module NITF;

import spicy;

public type Header = unit {
    magic: bytes &size=4;
    version: uint8;
    flags: uint8;
    header_length: uint16;
    data_length: uint32;
};

public type ImageSegment = unit {
    segment_type: uint8;
    segment_length: uint32;
    data: bytes &size=segment_length;
};

public type NITF_File = unit {
    header: Header;
    segments: ImageSegment[] &until($input.size() == 0);
};

on NITF_File::%init {
    print "NITF file parsed successfully!";
}