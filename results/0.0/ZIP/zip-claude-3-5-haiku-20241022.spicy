module ZIP;

import spicy;

public type Header = unit {
    signature: bytes(4) &requires($$=="PK\x03\x04");
    version: uint16;
    flags: uint16;
    compression_method: uint16;
    last_mod_time: uint16;
    last_mod_date: uint16;
    crc32: uint32;
    compressed_size: uint32;
    uncompressed_size: uint32;
    filename_length: uint16;
    extra_field_length: uint16;
    filename: bytes(filename_length);
    extra_field: bytes(extra_field_length) &optional;

    on %done {
        print fmt("ZIP File: %s", filename);
    }
};

public type File = unit {
    headers: Header[];
};