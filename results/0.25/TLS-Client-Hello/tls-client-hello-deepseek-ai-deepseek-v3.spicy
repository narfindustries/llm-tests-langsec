module TLS;

import spicy;

type ClientHello = unit {
    legacy_version: uint16;
    random: bytes &size=32;
    legacy_session_id: bytes &size=8 &until=b"\x20";
    cipher_suites: bytes &size=2 &until=b"\xFF\xFF";
    legacy_compression_methods: bytes &size=1 &until=b"\x00";
    extensions: bytes &size=2 &until=b"\xFF\xFF";

    on %init {
        self.legacy_version = 0x0303;
        self.random = b"\x00\x01\x02\x03\x04\x05\x06\x07\x08\x09\x0A\x0B\x0C\x0D\x0E\x0F\x10\x11\x12\x13\x14\x15\x16\x17\x18\x19\x1A\x1B\x1C\x1D\x1E\x1F";
        self.legacy_session_id = b"";
        self.cipher_suites = b"\x13\x01\x13\x02\x13\x03";
        self.legacy_compression_methods = b"\x00";
        self.extensions = b"\x00\x0A\x00\x04\x00\x02\x00\x17\x00\x0D\x00\x04\x00\x02\x08\x04\x00\x2B\x00\x02\x03\x04\x00\x2D\x00\x02\x01\x01\x00\x29\x00\x10\x00\x0E\x00\x0B\x00\x09\x08\x68\x74\x74\x70\x2F\x32\x00\x2A\x00\x01\x01\x00\x2C\x00\x02\x00\x00\x00\x15\x00\x01\x00\x31\x00\x01\x01\x00\x1C\x00\x02\x40\x00\xFF\x01\x00\x01\x00";
    }
};