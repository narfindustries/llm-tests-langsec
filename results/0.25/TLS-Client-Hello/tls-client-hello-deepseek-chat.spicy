module TLS_Client_Hello;

import spicy;

export type ClientHello = unit {
    handshake_type: uint8;
    length: uint24;
    version: uint16;
    random: bytes &size=32;
    session_id_length: uint8;
    session_id: bytes &size=session_id_length;
    cipher_suites_length: uint16;
    cipher_suites: bytes &size=cipher_suites_length;
    compression_methods_length: uint8;
    compression_methods: bytes &size=compression_methods_length;
    extensions_length: uint16;
    extensions: bytes &size=extensions_length;
};

on ClientHello::%done {
    print "TLS Client Hello parsed successfully";
}