<?xml version="1.0" encoding="UTF-8"?>
<xs:schema xmlns:xs="http://www.w3.org/2001/XMLSchema"
           xmlns:dfdl="http://www.ogf.org/dfdl/dfdl-1.0/"
           xmlns:daf="http://www.ogf.org/dfdl/dfdl-1.0/"
           targetNamespace="http://www.example.org/tls-client-hello"
           xmlns:tls="http://www.example.org/tls-client-hello"
           elementFormDefault="qualified">

  <xs:annotation>
    <xs:appinfo source="http://www.ogf.org/dfdl/">
      <dfdl:format ref="tns:GeneralFormat" />
    </xs:appinfo>
  </xs:annotation>

  <xs:complexType name="TLSClientHelloType">
    <xs:sequence>
      <xs:element name="recordType" type="xs:unsignedByte" dfdl:length="1" dfdl:lengthKind="explicit" />
      <xs:element name="version" type="xs:unsignedShort" dfdl:length="2" dfdl:lengthKind="explicit" />
      <xs:element name="random" type="xs:hexBinary" dfdl:length="32" dfdl:lengthKind="explicit" />
      <xs:element name="sessionID" dfdl:lengthKind="implicit">
        <xs:complexType>
          <xs:sequence>
            <xs:element name="sessionIDLength" type="xs:unsignedByte" dfdl:length="1" dfdl:lengthKind="explicit" />
            <xs:element name="sessionIDValue" type="xs:hexBinary" dfdl:length="{../sessionIDLength}" dfdl:lengthKind="explicit" />
          </xs:sequence>
        </xs:complexType>
      </xs:element>
      <xs:element name="cipherSuites" dfdl:lengthKind="implicit">
        <xs:complexType>
          <xs:sequence>
            <xs:element name="cipherSuitesLength" type="xs:unsignedShort" dfdl:length="2" dfdl:lengthKind="explicit" />
            <xs:element name="cipherSuite" type="xs:unsignedShort" dfdl:length="2" dfdl:lengthKind="explicit" maxOccurs="unbounded" />
          </xs:sequence>
        </xs:complexType>
      </xs:element>
      <xs:element name="compressionMethods" dfdl:lengthKind="implicit">
        <xs:complexType>
          <xs:sequence>
            <xs:element name="compressionMethodsLength" type="xs:unsignedByte" dfdl:length="1" dfdl:lengthKind="explicit" />
            <xs:element name="compressionMethod" type="xs:unsignedByte" dfdl:length="1" dfdl:lengthKind="explicit" maxOccurs="unbounded" />
          </xs:sequence>
        </xs:complexType>
      </xs:element>
      <xs:element name="extensions" dfdl:lengthKind="implicit" minOccurs="0">
        <xs:complexType>
          <xs:sequence>
            <xs:element name="extensionsLength" type="xs:unsignedShort" dfdl:length="2" dfdl:lengthKind="explicit" />
            <xs:element name="extension" maxOccurs="unbounded">
              <xs:complexType>
                <xs:sequence>
                  <xs:element name="extensionType" type="xs:unsignedShort" dfdl:length="2" dfdl:lengthKind="explicit" />
                  <xs:element name="extensionLength" type="xs:unsignedShort" dfdl:length="2" dfdl:lengthKind="explicit" />
                  <xs:element name="extensionData" type="xs:hexBinary" dfdl:length="{../extensionLength}" dfdl:lengthKind="explicit" />
                </xs:sequence>
              </xs:complexType>
            </xs:element>
          </xs:sequence>
        </xs:complexType>
      </xs:element>
    </xs:sequence>
  </xs:complexType>

  <xs:element name="TLSClientHello" type="tls:TLSClientHelloType" />

  <dfdl:defineFormat name="GeneralFormat">
    <dfdl:format representation="binary" byteOrder="bigEndian" />
  </dfdl:defineFormat>

</xs:schema>