module ARP;

public type Packet = unit {
    hw_type: uint16;
    proto_type: uint16;
    hw_size: uint8;
    proto_size: uint8;
    op_code: uint16;
    sender_mac: bytes &size=6;
    sender_ip: bytes &size=4;
    target_mac: bytes &size=6;
    target_ip: bytes &size=4;

    on %done {
        print self;
    }
};

type Operation = enum {
    REQUEST = 1,
    REPLY = 2
};