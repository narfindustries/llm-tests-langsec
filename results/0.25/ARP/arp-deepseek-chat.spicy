module ARP;

public type Header = unit {
    htype: uint16;
    ptype: uint16;
    hlen: uint8;
    plen: uint8;
    oper: uint16;
    sha: bytes &size=6;
    spa: bytes &size=4;
    tha: bytes &size=6;
    tpa: bytes &size=4;

    on %done {
        if ( self.htype == 1 && self.ptype == 0x0800 ) {
            print "ARP packet detected";
        }
    }
};