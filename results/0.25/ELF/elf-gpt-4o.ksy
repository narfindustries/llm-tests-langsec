meta:
  id: elf
  title: Executable and Linkable Format
  file-extension: elf
  endian: le
  license: MIT

seq:
  - id: magic
    contents: [0x7f, 0x45, 0x4c, 0x46] # "\x7FELF"

  - id: bits
    type: u1

  - id: endian
    type: u1
    enum: endian

  - id: version
    type: u1

  - id: abi
    type: u1

  - id: abi_version
    type: u1

  - id: pad
    size: 7

  - id: e_type
    type: u2
    enum: obj_type

  - id: e_machine
    type: u2
    enum: machine

  - id: e_version
    type: u4

  - id: entry_point
    type: u4

  - id: program_header_offset
    type: u4

  - id: section_header_offset
    type: u4

  - id: flags
    type: u4

  - id: e_ehsize
    type: u2

  - id: program_header_entry_size
    type: u2

  - id: qty_program_header
    type: u2

  - id: section_header_entry_size
    type: u2

  - id: qty_section_header
    type: u2

  - id: section_names_idx
    type: u2

enums:
  endian:
    1: le
    2: be

  obj_type:
    0: no_file_type
    1: relocatable
    2: executable
    3: shared
    4: core

  machine:
    0: no_machine
    1: m32
    2: sparc
    3: i386
    4: m68k
    5: m88k
    6: i486
    7: i860
    8: mips
    9: s370
    10: mips_rs3_le
    11: parisc
    12: vpp500
    13: sparc32plus
    14: i960
    15: ppc
    16: ppc64
    17: s390
    18: spu
    19: v800
    20: fr20
    21: rh32
    22: rce
    23: arm
    24: alpha
    25: sh
    26: sparcv9
    27: tricore
    28: arc
    29: h8_300
    30: h8_300h
    31: h8s
    32: h8_500
    33: ia_64
    34: mips_x
    35: coldfire
    36: m68hc12
    37: mma
    38: pcp
    39: ncpu
    40: ndr1
    41: starcore
    42: me16
    43: st100
    44: tinyj
    45: x86_64
    46: pdsp
    47: fx66
    48: st9plus
    49: st7
    50: m68hc16
    51: m68hc11
    52: m68hc08
    53: m68hc05
    54: svx
    55: st19
    56: vax
    57: cris
    58: javelin
    59: firepath
    60: zsp
    61: mmix
    62: huany
    63: prism
    64: avr
    65: fr30
    66: d10v
    67: d30v
    68: v850
    69: m32r
    70: mn10300
    71: mn10200
    72: picojava
    73: openrisc
    74: arc_compact
    75: xtensa
    76: video_core
    77: tmm_gpp
    78: ns32k
    79: tpc
    80: s1c33
    81: s1c34
    82: s1c39
    83: v800_1
    84: v850_1
    85: v850_2
    86: v850_3
    87: v850_4
    88: v850_5
    89: v850_6
    90: v850_7
    91: v850_8
    92: v850_9
    93: v850_10
    94: v850_11
    95: v850_12
    96: v850_13
    97: v850_14
    98: v850_15
    99: v850_16
    100: v850_17
    101: v850_18
    102: v850_19
    103: v850_20
    104: v850_21
    105: v850_22
    106: v850_23
    107: v850_24
    108: v850_25
    109: v850_26
    110: v850_27
    111: v850_28
    112: v850_29
    113: v850_30
    114: v850_31
    115: v850_32
    116: v850_33
    117: v850_34
    118: v850_35
    119: v850_36
    120: v850_37
    121: v850_38
    122: v850_39
    123: v850_40
    124: v850_41
    125: v850_42
    126: v850_43
    127: v850_44
    128: v850_45
    129: v850_46
    130: v850_47
    131: v850_48
    132: v850_49
    133: v850_50
    134: v850_51
    135: v850_52
    136: v850_53
    137: v850_54
    138: v850_55
    139: v850_56
    140: v850_57
    141: v850_58
    142: v850_59
    143: v850_60
    144: v850_61
    145: v850_62
    146: v850_63
    147: v850_64
    148: v850_65
    149: v850_66
    150: v850_67
    151: v850_68
    152: v850_69
    153: v850_70
    154: v850_71
    155: v850_72
    156: v850_73
    157: v850_74
    158: v850_75
    159: v850_76
    160: v850_77
    161: v850_78
    162: v850_79
    163: v850_80
    164: v850_81
    165: v850_82
    166: v850_83
    167: v850_84
    168: v850_85
    169: v850_86
    170: v850_87
    171: v850_88
    172: v850_89
    173: v850_90
    174: v850_91
    175: v850_92
    176: v850_93
    177: v850_94
    178: v850_95
    179: v850_96
    180: v850_97
    181: v850_98
    182: v850_99
    183: v850_100
    184: v850_101
    185: v850_102
    186: v850_103
    187: v850_104
    188: v850_105
    189: v850_106
    190: v850_107
    191: v850_108
    192: v850_109
    193: v850_110
    194: v850_111
    195: v850_112
    196: v850_113
    197: v850_114
    198: v850_115
    199: v850_116
    200: v850_117
    201: v850_118
    202: v850_119
    203: v850_120
    204: v850_121
    205: v850_122
    206: v850_123
    207: v850_124
    208: v850_125
    209: v850_126
    210: v850_127
    211: v850_128
    212: v850_129
    213: v850_130
    214: v850_131
    215: v850_132
    216: v850_133
    217: v850_134
    218: v850_135
    219: v850_136
    220: v850_137
    221: v850_138
    222: v850_139
    223: v850_140
    224: v850_141
    225: v850_142
    226: v850_143
    227: v850_144
    228: v850_145
    229: v850_146
    230: v850_147
    231: v850_148
    232: v850_149
    233: v850_150
    234: v850_151
    235: v850_152
    236: v850_153
    237: v850_154
    238: v850_155
    239: v850_156
    240: v850_157
    241: v850_158
    242: v850_159
    243: v850_160
    244: v850_161
    245: v850_162
    246: v850_163
    247: v850_164
    248: v850_165
    249: v850_166
    250: v850_167
    251: v850_168
    252: v850_169
    253: v850_170
    254: v850_171
    255: v850_172
    256: v850_173
    257: v850_174
    258: v850_175
    259: v850_176
    260: v850_177
    261: v850_178
    262: v850_179
    263: v850_180
    264: v850_181
    265: v850_182
    266: v850_183
    267: v850_184
    268: v850_185
    269: v850_186
    270: v850_187
    271: v850_188
    272: v850_189
    273: v850_190
    274: v850_191
    275: v850_192
    276: v850_193
    277: v850_194
    278: v850_195
    279: v850_196
    280: v850_197
    281: v850_198
    282: v850_199
    283: v850_200
    284: v850_201
    285: v850_202
    286: v850_203
    287: v850_204
    288: v850_205
    289: v850_206
    290: v850_207
    291: v850_208
    292: v850_209
    293: v850_210
    294: v850_211
    295: v850_212
    296: v850_213
    297: v850_214
    298: v850_215
    299: v850_216
    300: v850_217
    301: v850_218
    302: v850_219
    303: v850_220
    304: v850_221
    305: v850_222
    306: v850_223
    307: v850_224
    308: v850_225
    309: v850_226
    310: v850_227
    311: v850_228
    312: v850_229
    313: v850_230
    314: v850_231
    315: v850_232
    316: v850_233
    317: v850_234
    318: v850_235
    319: v850_236
    320: v850_237
    321: v850_238
    322: v850_239
    323: v850_240
    324: v850_241
    325: v850_242
    326: v850_243
    327: v850_244
    328: v850_245
    329: v850_246
    330: v850_247
    331: v850_248
    332: v850_249
    333: v850_250
    334: v850_251
    335: v850_252
    336: v850_253
    337: v850_254
    338: v850_255
    339: v850_256
    340: v850_257
    341: v850_258
    342: v850_259
    343: v850_260
    344: v850_261
    345: v850_262
    346: v850_263
    347: v850_264
    348: v850_265
    349: v850_266
    350: v850_267
    351: v850_268
    352: v850_269
    353: v850_270
    354: v850_271
    355: v850_272
    356: v850_273
    357: v850_274
    358: v850_275
    359: v850_276
    360: v850_277
    361: v850_278
    362: v850_279
    363: v850_280
    364: v850_281
    365: v850_282
    366: v850_283
    367: v850_284
    368: v850_285
    369: v850_286
    370: v850_287
    371: v850_288
    372: v850_289
    373: v850_290
    374: v850_291
    375: v850_292
    376: v850_293
    377: v850_294
    378: v850_295
    379: v850_296
    380: v850_297
    381: v850_298
    382: v850_299
    383: v850_300
    384: v850_301
    385: v850_302
    386: v850_303
    387: v850_304
    388: v850_305
    389: v850_306
    390: v850_307
    391: v850_308
    392: v850_309
    393: v850_310
    394: v850_311
    395: v850_312
    396: v850_313
    397: v850_314
    398: v850_315
    399: v850_316
    400: v850_317
    401: v850_318
    402: v850_319
    403: v850_320
    404: v850_321
    405: v850_322
    406: v850_323
    407: v850_324
    408: v850_325
    409: v850_326
    410: v850_327
    411: v850_328
    412: v850_329
    413: v850_330
    414: v850_331
    415: v850_332
    416: v850_333
    417: v850_334
    418: v850_335
    419: v850_336
    420: v850_337
    421: v850_338
    422: v850_339
    423: v850_340
