<?xml version="1.0" encoding="UTF-8"?>
<schema xmlns="http://www.w3.org/2001/XMLSchema"
        xmlns:dfdl="http://www.ogf.org/dfdl/dfdl-1.0/"
        targetNamespace="http://example.com/tls-client-hello"
        xmlns:tns="http://example.com/tls-client-hello"
        elementFormDefault="qualified">

  <dfdl:format ref="tns:TLSClientHelloFormat"/>

  <dfdl:defineFormat name="TLSClientHelloFormat">
    <dfdl:format lengthKind="explicit"
                 encoding="utf-8"
                 byteOrder="bigEndian"
                 alignmentUnits="bytes"/>
  </dfdl:defineFormat>

  <element name="TLSClientHello" type="tns:TLSClientHelloType"/>

  <complexType name="TLSClientHelloType">
    <sequence>
      <element name="handshakeType" type="unsignedByte">
        <dfdl:length value="1" lengthUnits="bytes"/>
      </element>
      <element name="length" type="unsignedShort">
        <dfdl:length value="2" lengthUnits="bytes"/>
      </element>
      <element name="version" type="unsignedShort">
        <dfdl:length value="2" lengthUnits="bytes"/>
      </element>
      <element name="random" type="tns:RandomType"/>
      <element name="sessionId" type="tns:SessionIdType"/>
      <element name="cipherSuites" type="tns:CipherSuitesType"/>
      <element name="compressionMethods" type="tns:CompressionMethodsType"/>
      <!-- Add extensions if needed -->
    </sequence>
  </complexType>

  <complexType name="RandomType">
    <sequence>
      <element name="gmtUnixTime" type="unsignedInt">
        <dfdl:length value="4" lengthUnits="bytes"/>
      </element>
      <element name="randomBytes" type="hexBinary">
        <dfdl:length value="28" lengthUnits="bytes"/>
      </element>
    </sequence>
  </complexType>

  <complexType name="SessionIdType">
    <sequence>
      <element name="sessionIdLength" type="unsignedByte">
        <dfdl:length value="1" lengthUnits="bytes"/>
      </element>
      <element name="sessionId" type="hexBinary">
        <dfdl:length expression="{../sessionIdLength}" lengthUnits="bytes"/>
      </element>
    </sequence>
  </complexType>

  <complexType name="CipherSuitesType">
    <sequence>
      <element name="cipherSuitesLength" type="unsignedShort">
        <dfdl:length value="2" lengthUnits="bytes"/>
      </element>
      <element name="cipherSuites" type="hexBinary">
        <dfdl:length expression="{../cipherSuitesLength}" lengthUnits="bytes"/>
      </element>
    </sequence>
  </complexType>

  <complexType name="CompressionMethodsType">
    <sequence>
      <element name="compressionMethodsLength" type="unsignedByte">
        <dfdl:length value="1" lengthUnits="bytes"/>
      </element>
      <element name="compressionMethods" type="hexBinary">
        <dfdl:length expression="{../compressionMethodsLength}" lengthUnits="bytes"/>
      </element>
    </sequence>
  </complexType>

</schema>