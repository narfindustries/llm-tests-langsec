@header {{ 
  author = "Generated Specification" 
  description = "TLS Client Hello" 
  version = "0.5"
}}

type TLSClientHello = record {
  handshake_type: uint8 = 0x01,
  length: uint24,
  version: uint16 = 0x0303,
  random: bytestring(32),
  session_id_length: uint8,
  session_id: bytestring &length=session_id_length,
  cipher_suites_length: uint16,
  cipher_suites: array of uint16 &length=cipher_suites_length/2,
  compression_methods_length: uint8,
  compression_methods: array of uint8 &length=compression_methods_length,
  extensions_length: uint16,
  extensions: array of TLSExtension &length=extensions_length,
} &byteorder=littleendian;

type TLSExtension = record {
  extension_type: uint16,
  extension_length: uint16,
  extension_data: bytestring &length=extension_length,
};

type TLSClientHelloMessage = record {
  content: TLSClientHello,
} &byteorder=littleendian;

module TLSClientHello;