module TLS;

import spicy;

public type ClientHello = unit {
    record_type: uint8 = 22;
    version: uint16;
    length: uint16;

    handshake_type: uint8 = 1;
    handshake_length: uint24;
    client_version: uint16;
    random: bytes(32);
    session_id_length: uint8;
    session_id: bytes(session_id_length);
    cipher_suites_length: uint16;
    cipher_suites: bytes(cipher_suites_length);
    compression_methods_length: uint8;
    compression_methods: bytes(compression_methods_length);

    extensions_length: uint16;
    extensions: list<Extension> if ( extensions_length > 0 );

    type Extension = unit {
        type: uint16;
        length: uint16;
        data: bytes(length);
    }
}