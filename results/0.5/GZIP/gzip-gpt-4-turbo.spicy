module GZIP;

public type GzipHeader = unit {
    id1: uint8;
    id2: uint8;
    cm: uint8;
    flg: uint8;
    mtime: uint32;
    xfl: uint8;
    os: uint8;

    on %init {
        if ( self.id1 != 0x1f || self.id2 != 0x8b ) {
            throw Error("Not a valid GZIP header");
        }
    }
};

public type GzipFooter = unit {
    crc32: uint32;
    input_size: uint32;
};

public type GzipFile = unit {
    header: GzipHeader;
    data: bytes &size=self.header.input_size;
    footer: GzipFooter;
};