module Network_Time_Protocol_Version_4;

export {
    type NTP_Packet = unit {
        leap_indicator: uint8 &convert=static_cast<uint8_t>((value >> 6) & 0x03);
        version: uint8 &convert=static_cast<uint8_t>((value >> 3) & 0x07);
        mode: uint8 &convert=static_cast<uint8_t>(value & 0x07);
        stratum: uint8;
        poll: uint8;
        precision: uint8;
        root_delay: uint32;
        root_dispersion: uint32;
        reference_id: uint32;
        reference_timestamp: uint64;
        origin_timestamp: uint64;
        receive_timestamp: uint64;
        transmit_timestamp: uint64;
    };
}

on NTP_Packet::%done {
    print self;
}