module NITF;

public type FileHeader = unit {
    fileTypeID: /[A-Z0-9]{9}/;
    fileTitle: /[A-Z0-9]{80}/;
    fileSecurityClass: /[A-Z0-9]{1}/;
    fileCopyNumber: /[A-Z0-9]{5}/;
    fileNumOfCopys: /[A-Z0-9]{5}/;
    fileBgColor: /[A-Z0-9]{3}/;
    fileOriginStationID: /[A-Z0-9]{10}/;
    fileDateTime: /[0-9]{14}/;
    fileTitle2: /[A-Z0-9]{80}/;
    : void { print self; }
};

public type ImageSegment = unit {
    imageID: /[A-Z0-9]{10}/;
    imageDateTime: /[0-9]{14}/;
    targetID: /[A-Z0-9]{17}/;
    imageTitle: /[A-Z0-9]{80}/;
    : void { print self; }
};

public type TextSegment = unit {
    textID: /[A-Z0-9]{7}/;
    textDateTime: /[0-9]{14}/;
    textTitle: /[A-Z0-9]{80}/;
    textFormat: /[A-Z0-9]{3}/;
    : void { print self; }
};

public type DataExtensionSegment = unit {
    desID: /[A-Z0-9]{25}/;
    desVersion: /[A-Z0-9]{2}/;
    desDateTime: /[0-9]{14}/;
    desTitle: /[A-Z0-9]{80}/;
    : void { print self; }
};

public type ReservedExtensionSegment = unit {
    resID: /[A-Z0-9]{25}/;
    resVersion: /[A-Z0-9]{2}/;
    resDateTime: /[0-9]{14}/;
    resTitle: /[A-Z0-9]{80}/;
    : void { print self; }
};

public type NITF = unit {
    header: FileHeader;
    imageSegments: ImageSegment[] &size=2;
    textSegments: TextSegment[] &size=2;
    dataExtensionSegments: DataExtensionSegment[] &size=2;
    reservedExtensionSegments: ReservedExtensionSegment[] &size=2;
    : void { print self; }
};