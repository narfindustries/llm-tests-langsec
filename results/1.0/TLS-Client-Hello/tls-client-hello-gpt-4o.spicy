module TLSClientHello;

public type ClientHello = unit {
    version: uint16;
    random: Random;
    session_id_length: uint8;
    session_id: bytes &length=session_id_length;
    cipher_suites_length: uint16;
    cipher_suites: array of uint16 &length=cipher_suites_length / 2;
    compression_methods_length: uint8;
    compression_methods: array of uint8 &length=compression_methods_length;
    extensions_length: uint16;
    extensions: array of Extension &length=extensions_length;
};

type Random = unit {
    gmt_unix_time: uint32;
    random_bytes: bytes &length=28;
};

type Extension = unit {
    extension_type: uint16;
    extension_length: uint16;
    extension_data: bytes &length=extension_length;
};

public function parse_client_hello(data: bytes) : ClientHello {
    return (parse as ClientHello) data;
}