Here's the complete Spicy specification for ARP parsing:

module ARP;

import spicy;

public type Packet = struct {
    hard_type: uint16;
    proto_type: uint16;
    hard_size: uint8;
    proto_size: uint8;
    opcode: uint16;
    sender_mac: bytes;
    sender_ip: bytes;
    target_mac: bytes;
    target_ip: bytes;
} &byte-order=network;

public type Parser = unit {
    packet: Packet;

    on packet validate {
        self.packet.hard_type == 1 &&   # Ethernet
        self.packet.proto_type == 0x0800 &&  # IPv4
        self.packet.hard_size == 6 &&   # MAC address size
        self.packet.proto_size == 4;    # IP address size
    }
} &byte-order=network;