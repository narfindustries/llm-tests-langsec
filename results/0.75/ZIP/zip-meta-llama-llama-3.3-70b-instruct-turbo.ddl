type LocalFileHeader = struct {
  signature: uint32 = 0x04034b50,
  versionNeededToExtract: uint16,
  generalPurposeBitFlag: uint16,
    encryption: bool @ 0,
    compression: bool @ 1,
    dataDescriptor: bool @ 2,
    enhancedDeflation: bool @ 3,
    compressedPatchedData: bool @ 4,
    strongEncryption: bool @ 5,
  compressionMethod: uint16,
    0: stored,
    1: shrunk,
    2: reduced,
    3: imploded,
    4: tokenized,
    5: deflated,
    6: deflated64,
    7: imploded64,
    8: enhancedDeflated,
    9: pkwareDclImploded,
  lastModifiedTime: uint16,
    seconds: uint16 @ 0-4,
    minutes: uint16 @ 5-10,
    hours: uint16 @ 11-15,
  lastModifiedDate: uint16,
    day: uint16 @ 0-4,
    month: uint16 @ 5-8,
    year: uint16 @ 9-15,
  crc32: uint32,
  compressedSize: uint32,
  uncompressedSize: uint32,
  filenameLength: uint16,
  extraFieldLength: uint16,
}

type CentralDirectoryHeader = struct {
  signature: uint32 = 0x02014b50,
  versionMadeBy: uint16,
  versionNeededToExtract: uint16,
  generalPurposeBitFlag: uint16,
    encryption: bool @ 0,
    compression: bool @ 1,
    dataDescriptor: bool @ 2,
    enhancedDeflation: bool @ 3,
    compressedPatchedData: bool @ 4,
    strongEncryption: bool @ 5,
  compressionMethod: uint16,
    0: stored,
    1: shrunk,
    2: reduced,
    3: imploded,
    4: tokenized,
    5: deflated,
    6: deflated64,
    7: imploded64,
    8: enhancedDeflated,
    9: pkwareDclImploded,
  lastModifiedTime: uint16,
    seconds: uint16 @ 0-4,
    minutes: uint16 @ 5-10,
    hours: uint16 @ 11-15,
  lastModifiedDate: uint16,
    day: uint16 @ 0-4,
    month: uint16 @ 5-8,
    year: uint16 @ 9-15,
  crc32: uint32,
  compressedSize: uint32,
  uncompressedSize: uint32,
  filenameLength: uint16,
  extraFieldLength: uint16,
  fileCommentLength: uint16,
  diskNumberStart: uint16,
  internalAttributes: uint16,
    asciiOrBinary: bool @ 0,
  externalAttributes: uint32,
  localHeaderOffset: uint32,
}

type EndOfCentralDirectory = struct {
  signature: uint32 = 0x06054b50,
  numberOfThisDisk: uint16,
  numberOfTheDiskWhereTheCentralDirectoryStarts: uint16,
  numberOfEntriesInTheCentralDirectoryOnThisDisk: uint16,
  totalNumberOfEntriesInTheCentralDirectory: uint16,
  sizeOfTheCentralDirectory: uint32,
  offsetOfTheStartOfTheCentralDirectory: uint32,
  commentLength: uint16,
}

type ZipFile = struct {
  localFileHeader: LocalFileHeader,
  filename: bytes @length localFileHeader.filenameLength,
  extraField: bytes @length localFileHeader.extraFieldLength,
  fileData: bytes @length localFileHeader.compressedSize,
  centralDirectoryHeader: CentralDirectoryHeader,
  centralDirectoryFilename: bytes @length centralDirectoryHeader.filenameLength,
  centralDirectoryExtraField: bytes @length centralDirectoryHeader.extraFieldLength,
  centralDirectoryFileComment: bytes @length centralDirectoryHeader.fileCommentLength,
  endOfCentralDirectory: EndOfCentralDirectory,
  zipMetaComment: bytes @length endOfCentralDirectory.commentLength,
}