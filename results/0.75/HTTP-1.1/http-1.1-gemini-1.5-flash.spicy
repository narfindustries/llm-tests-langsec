#ifndef HTTP_1_1_GEMINI_1_5_FLASH_SPICY
#define HTTP_1_1_GEMINI_1_5_FLASH_SPICY

#include <http.zeek>
#include <gemini.zeek>

event http_request(HTTP::Request r)
	{
	//Check if it's a flash request
	if (r.URI.contains(".swf"))
		{
		//Log the event
		print fmt("Flash request detected: %s", r.URI);

		//Perform further analysis based on the HTTP headers or the request itself
		//For example:
		//if (r.header("User-Agent").contains("Flash"))
		//	{
		//	print fmt("Request from Flash client: %s", r.header("User-Agent"));
		//	}
		}
	}

event gemini_request(Gemini::Request r)
	{
	//Check if it's a flash request
	if (r.URI.contains(".swf"))
		{
		//Log the event
		print fmt("Flash request detected: %s", r.URI);

		//Perform further analysis based on the Gemini headers or the request itself
		//For example:
		//if (r.header("User-Agent").contains("Flash"))
		//	{
		//	print fmt("Request from Flash client: %s", r.header("User-Agent"));
		//	}
		}
	}


#endif
