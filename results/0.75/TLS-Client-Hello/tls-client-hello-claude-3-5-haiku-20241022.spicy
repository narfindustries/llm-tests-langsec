module TLS;

import spicy;

public type ClientHello = unit {
    record_type: uint8 = 0x16;  # Handshake record type
    version: uint16;             # Protocol version
    length: uint16;              # Length of the handshake message

    handshake_type: uint8 = 0x01;  # ClientHello type
    handshake_length: uint24;      # Length of handshake message

    client_version: uint16;         # Client-supported protocol version
    random: bytes(32);              # Random bytes for connection

    session_id_length: uint8;
    session_id: bytes(session_id_length);

    cipher_suites_length: uint16;
    cipher_suites: list<uint16>(count=cipher_suites_length/2);

    compression_methods_length: uint8;
    compression_methods: bytes(compression_methods_length);

    extensions_length: uint16;
    extensions: list<Extension>(count=extensions_length);

    type Extension = unit {
        type: uint16;
        length: uint16;
        data: bytes(length);
    }
};