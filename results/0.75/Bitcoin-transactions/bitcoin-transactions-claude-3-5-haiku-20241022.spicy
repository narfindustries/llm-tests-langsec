module Bitcoin;

import spicy;

public type Transaction = unit {
    version     : uint32;
    num_inputs  : varint;
    inputs      : Input[self.num_inputs];
    num_outputs : varint;
    outputs     : Output[self.num_outputs];
    locktime    : uint32;

    type Input = unit {
        prev_tx_hash    : bytes(32);
        prev_tx_output  : uint32;
        script_length   : varint;
        script_sig      : bytes(self.script_length);
        sequence_number : uint32;
    }

    type Output = unit {
        value           : uint64;
        script_length   : varint;
        script_pubkey   : bytes(self.script_length);
    }
}

public type BitcoinTransactionFile = unit {
    transactions: Transaction[] &eod;
}