module SQLITE3_DB;

export {
    type Header = unit {
        magic: bytes &size=16;
        page_size: uint16;
        file_format_write_version: uint8;
        file_format_read_version: uint8;
        reserved_space: uint8;
        max_embedded_payload_fraction: uint8;
        min_embedded_payload_fraction: uint8;
        leaf_payload_fraction: uint8;
        file_change_counter: uint32;
        database_size_in_pages: uint32;
        first_freelist_trunk_page: uint32;
        total_freelist_pages: uint32;
        schema_cookie: uint32;
        schema_format_number: uint32;
        default_page_cache_size: uint32;
        largest_root_btree_page: uint32;
        database_text_encoding: uint32;
        user_version: uint32;
        incremental_vacuum_mode: uint32;
        application_id: uint32;
        version_valid_for: uint32;
        sqlite_version_number: uint32;
    };

    type Page = unit {
        header: Header;
        data: bytes &size=header.page_size - 16;
    };

    type SQLite3DB = unit {
        pages: Page[] &until($input.size() == 0);
    };
}