#ifndef SQLITE3_DB_GEMINI_1_H
#define SQLITE3_DB_GEMINI_1_H

#include <zeek/zeek-config.h>

#ifdef HAVE_SQLITE3

#include <sqlite3.h>

typedef struct {
  sqlite3* db;
} sqlite3_db_t;


/// @brief Opens a SQLite3 database.
/// @param[in] filename The path to the database file.
/// @param[out] db A pointer to a sqlite3_db_t structure.
/// @return 0 on success, -1 on failure.
int sqlite3_db_open(const char* filename, sqlite3_db_t* db);

/// @brief Closes a SQLite3 database.
/// @param[in] db A pointer to a sqlite3_db_t structure.
/// @return 0 on success, -1 on failure.
int sqlite3_db_close(sqlite3_db_t* db);

/// @brief Executes a SQL query.
/// @param[in] db A pointer to a sqlite3_db_t structure.
/// @param[in] query The SQL query to execute.
/// @return 0 on success, -1 on failure.
int sqlite3_db_execute(sqlite3_db_t* db, const char* query);


#else

typedef struct {
  // Placeholder for SQLite3 functionality.
} sqlite3_db_t;

int sqlite3_db_open(const char* filename, sqlite3_db_t* db) { return -1; }
int sqlite3_db_close(sqlite3_db_t* db) { return 0; }
int sqlite3_db_execute(sqlite3_db_t* db, const char* query) { return -1; }

#endif // HAVE_SQLITE3

#endif // SQLITE3_DB_GEMINI_1_H


#include "sqlite3-db-gemini-1.h"

//Example Usage
int main() {
  sqlite3_db_t db;
  if (sqlite3_db_open("mydatabase.db", &db) == 0) {
    if (sqlite3_db_execute(&db, "CREATE TABLE IF NOT EXISTS mytable (id INTEGER PRIMARY KEY, value TEXT);") == 0) {
      if (sqlite3_db_execute(&db, "INSERT INTO mytable (value) VALUES ('Hello, world!');") == 0){
          //Success!
      } else {
          //Error inserting data
      }
    } else {
      //Error creating table
    }
    sqlite3_db_close(&db);
  } else {
    //Error opening database
  }
  return 0;
}
