module GZIP;

import spicy;

type GzipHeader = unit {
    id1: uint8;
    id2: uint8;
    compressionMethod: uint8;
    flags: uint8;
    mtime: uint32;
    extraFlags: uint8;
    os: uint8;

    on %init {
        if (self.id1 != 0x1F || self.id2 != 0x8B)
            throw ParseError("Not a valid GZIP header.");
    }
};

type GzipFooter = unit {
    crc32: uint32;
    inputSize: uint32;
};

type GzipFile = unit {
    header: GzipHeader;
    data: bytes &eod;
    footer: GzipFooter;
};

public type File = GzipFile;